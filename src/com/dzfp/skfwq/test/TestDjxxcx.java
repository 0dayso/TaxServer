package com.dzfp.skfwq.test;

import java.util.Calendar;

import junit.framework.TestCase;

import com.aisinogz.util.Base64Helper;
import com.dzfp.entity.comm.GlobalInfo;
import com.dzfp.entity.comm.Interface;
import com.dzfp.skfwq.factory.usb.IEInvWSDjxxcx;

/**
 * 登记信息查询接口测试
 * 
 * @author 陈捷
 *
 */
public class TestDjxxcx extends TestCase {

	/**
	 * 返回的内层报文进行解密
	 */
	public void testDecode() {
		String content = "CiAgPFJFU1BPTlNFX0ZQS0ogY2xhc3M9IlJFU1BPTlNFX0ZQS0oiPgogICAgPFJFVFVSTkNPREU+MDAwMDwvUkVUVVJOQ09ERT4KICAgIDxSRVRVUk5NRVNTQUdFPuW8gOelqOaIkOWKnzwvUkVUVVJOTUVTU0FHRT4KICAgIDxISkJIU0pFPjAuOTQ8L0hKQkhTSkU+CiAgICA8SEpTRT4wLjA2PC9ISlNFPgogICAgPEtQUlE+MjAxNjA5MjcxNTA1Mjk8L0tQUlE+CiAgICA8U1NZRj4yMDE2MDk8L1NTWUY+CiAgICA8RlBfRE0+MDUyMDAxNjAwMTExPC9GUF9ETT4KICAgIDxGUF9ITT4wMDAwMjA3NTwvRlBfSE0+CiAgICA8UkVUQ09ERT4wMDAwPC9SRVRDT0RFPgogICAgPEZXTVc+Kys5MzAqMjU4NyZndDs5LzYxNjAxJmd0OyotNDAvMDQ1Ni03OCsrKzE0NjgvNjIzJmd0Oy8vMjM0Jmx0OyZsdDs2MSozKzQzNTAmbHQ7Nyo0LSswODcmZ3Q7Ly82NzYxLzMqODUyOTgvNjc0NTgrKysxNDY4LzYyMyZndDsvLzI1LzgmbHQ7PC9GV01XPgogICAgPEpZTT43Njc3OTMyNjc3NDE5NTY5MTEyODwvSllNPgogICAgPFNaUU0+TUlJQlF3WUpLb1pJaHZjTkFRY0NvSUlCTkRDQ0FUQUNBUUV4Q3pBSkJnVXJEZ01DR2dVQU1Bc0dDU3FHU0liM0RRRUhBVEdDQVE4d2dnRUxBZ0VCTUdrd1hqRUxNQWtHQTFVRUJoTUNZMjR4RlRBVEJnTlZCQXNlREZiOVc3WjZEbEtoWUR0Y1FERWRNQnNHQTFVRUF4NFVlZzVTb1hVMVcxQ0x3VTVtZTZGMEJrNHRYOE14R1RBWEJnTlZCQTBlRUFCakFHRUFNUUF3QURBQU1BQXdBRElDQnpBQkFBQUlkYjB3Q1FZRkt3NERBaG9GQURBTkJna3Foa2lHOXcwQkFRRUZBQVNCZ0JFdVVZcTE3ckhaZVBYbjAwTXY3eTdDbERWcmQ0d2dEaitMRXVnYVZQUzFURSs0NlBVVk8wdGZYN0pFTkRBY1lOaGdDd2tJN0dBV2hZOVFtZkJXdlFNMGpESTg1SDV4T0pISXpjd1NTenk1bGdxR3dqMUMwTU16VWlNVnNueWNZVkdVUE5yeldlY3NKanFCankwdUwva1VrSGxMSTlNNHZ2Qi9Ub3l3dzIxajwvU1pRTT4KICAgIDxFV00+UWszQ0F3QUFBQUFBQUQ0QUFBQW9BQUFBU3dBQUFFc0FBQUFCQUFFQUFBQUFBSVFEQUFBQUFBQUFBQUFBQUFBQUFBQUNBQUFBQUFBQS8vLy8vLy8vLy8vLy8vLy8vLy9nQUFBQUF3UHp3QUREQU13Z0FBQUFBd1B6d0FEREFNd2dBQUEvODhQOC84OERQQS9nQUFBLzg4UDgvODhEUEEvZ0FBQXdNOERQTXo4RHpBQWdBQUF3TThEUE16OER6QUFnQUFBd013TUF6QUFQend6Z0FBQXdNd01BekFBUHp3emdBQUF3TThEd3pQQVBBRC9nQUFBd004RHd6UEFQQUQvZ0FBQS84eno4UEF6OFB3RGdBQUEvOHp6OFBBejhQd0RnQUFBQUE4RER6ek13TXdNZ0FBQUFBOEREenpNd013TWdBQUQvL3dBUHd3RC9Qd3dnQUFELy93QVB3d0QvUHd3Z0FBRC93L0RNQU0vd0FBTWdBQUQvdy9ETUFNL3dBQU1nQUFBelB6UERETS9Nek04Z0FBQXpQelBERE0vTXpNOGdBQURBd1BQd1B6enp3d0FnQUFEQXdQUHdQenp6d3dBZ0FBQS96d0Q4dy9QRE04OGdBQUEvendEOHcvUERNODhnQUFEdzhQUERNUC9EOE13Z0FBRHc4UFBETVAvRDhNd2dBQUR3L01QRDhEL0RQQXdnQUFEdy9NUEQ4RC9EUEF3Z0FBRERNUFB6OE1NendBOGdBQURETVBQejhNTXp3QThnQUFEUHpQd1B3Ly9QOFA4Z0FBRFB6UHdQdy8vUDhQOGdBQUFQQU1NUDhBRFB3QXdnQUFBUEFNTVA4QURQd0F3Z0FBQUQvOHc4QUF3d3pNRGdBQUFELzh3OEFBd3d6TURnQUFBUDg4eno4RDh6ODg4Z0FBQVA4OHp6OEQ4ejg4OGdBQUR3enc4TS9NTVB3RHdnQUFEd3p3OE0vTU1Qd0R3Z0FBQVBNREEvUEQ4ek04QWdBQUFQTURBL1BEOHpNOEFnQUFEL3o4UFBQQURBODh3Z0FBRC96OFBQUEFEQTg4d2dBQURNODhBLy8vQS9NUEFnQUFETTg4QS8vL0EvTVBBZ0FBRHcvLzhETU0vek0vOGdBQUR3Ly84RE1NL3pNLzhnQUFEd0FQTUFBd1BEOE04Z0FBRHdBUE1BQXdQRDhNOGdBQUFQUFBEelBBTVBNd3pnQUFBUFBQRHpQQU1QTXd6Z0FBRE1NOFA4OE1NRDg4TWdBQURNTThQODhNTUQ4OE1nQUFBUC9QLzhBTXdEOFB3Z0FBQVAvUC84QU13RDhQd2dBQUE4d3pQREFEd1B6UC9nQUFBOHd6UERBRHdQelAvZ0FBRC8vL0F3QXpQd1AvL2dBQUQvLy9Bd0F6UHdQLy9nQUFBQUF6TXpNek16TUFBZ0FBQUFBek16TXpNek1BQWdBQUEvOHpELy9EUEE4LzhnQUFBLzh6RC8vRFBBOC84Z0FBQXdNOHp3L3dBTTh3TWdBQUF3TTh6dy93QU04d01nQUFBd00venpQencvTXdNZ0FBQXdNL3p6UHp3L013TWdBQUF3TS9NOEFETXpNd01nQUFBd00vTThBRE16TXdNZ0FBQS84L3dQL01EODgvOGdBQUEvOC93UC9NRDg4LzhnQUFBQUE4ek1NL004TUFBZ0FBQUFBOHpNTS9NOE1BQWdBQUE9PC9FV00+CiAgPC9SRVNQT05TRV9GUEtKPgo=";
		System.out.println(Base64Helper.decode(content));
	}

	/**
	 * 登记信息查询测试
	 */
	public void testDjxx() {
		String content = "";// 登记信息查询的内层报文只要传空字符串
		// 数据请求流水号（演示）
		String dataExchangeId = "DJXX" + Long.toString(Calendar.getInstance().getTimeInMillis());
		// 通过公共报文工具返回请求报文
		Interface iface2 = CommTest.getIface("DJXXCX", dataExchangeId, content);
		GlobalInfo globalInfo = iface2.getGlobalInfo();
		globalInfo.setRequestCode("192.168.101.18:9998");
		iface2.setGlobalInfo(globalInfo);
		IEInvWSDjxxcx is = new IEInvWSDjxxcx();
		is.setIface(iface2);

		// 调用接口，返回响应报文信息
		String respXml = is.request();
		System.out.println(respXml);
		Interface iface = CommTest.fromXML(respXml);
		if (iface != null) {
			if ("0000".equals(iface.getReturnStateInfo().getReturnCode())) {
				content = iface.getData().getContent();
				System.out.println(Base64Helper.decode(content));
			} else {
				content = iface.getReturnStateInfo().getReturnMessage();
				System.out.println(Base64Helper.decode(content));
			}

		}
	}
}
